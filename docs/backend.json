{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile information.",
      "type": "object",
      "properties": {
        "email": { "type": "string", "format": "email" },
        "displayName": { "type": "string" }
      },
      "required": ["email"]
    },
    "Recipient": {
      "title": "Recipient",
      "description": "An email recipient imported from an Excel file. It's a flat object with an ownerId.",
      "type": "object",
      "properties": {
        "ownerId": { "type": "string", "description": "The UID of the user who owns this recipient." }
      },
      "required": ["ownerId"],
      "additionalProperties": {
        "anyOf": [
          { "type": "string" },
          { "type": "number" },
          { "type": "boolean" }
        ]
      }
    },
    "DeliveryLog": {
      "title": "Delivery Log",
      "description": "A log entry for an email delivery attempt.",
      "type": "object",
      "properties": {
        "ownerId": { "type": "string", "description": "The UID of the user who owns this log." },
        "emailKey": { "type": "string", "description": "A unique key to identify an email event to prevent duplicates." },
        "status": { "type": "string", "enum": ["Delivered", "Failed"] },
        "sentAt": { "type": "string", "format": "date-time" },
        "beneficiary": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "email": { "type": "string" },
            "initials": { "type": "string" }
          }
        },
        "trainer": { "type": "string" },
        "date": { "type": "string" }
      },
      "required": ["ownerId", "status", "sentAt", "beneficiary", "emailKey"]
    },
    "SmtpSettings": {
      "title": "SMTP Settings",
      "description": "User's SMTP configuration.",
      "type": "object",
      "properties": {
        "host": { "type": "string" },
        "port": { "type": "number" },
        "user": { "type": "string" },
        "pass": { "type": "string", "description": "User's SMTP password." },
        "secure": { "type": "boolean" },
        "savePassword": { "type": "boolean" }
      },
      "required": ["host", "port", "user", "secure"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous", "google.com"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/entities/UserProfile" },
          "description": "Stores user profile information."
        }
      },
      {
        "path": "/recipients/{recipientId}",
        "definition": {
          "entityName": "Recipient",
          "schema": { "$ref": "#/entities/Recipient" },
          "description": "Stores all email recipients, partitioned by owner."
        }
      },
      {
        "path": "/delivery-logs/{logId}",
        "definition": {
          "entityName": "DeliveryLog",
          "schema": { "$ref": "#/entities/DeliveryLog" },
          "description": "Stores all delivery logs, partitioned by owner."
        }
      },
      {
        "path": "/smtp-settings/{userId}",
        "definition": {
          "entityName": "SmtpSettings",
          "schema": { "$ref": "#/entities/SmtpSettings" },
          "description": "Stores SMTP settings for each user. The document ID is the user's UID."
        }
      }
    ],
    "reasoning": "The data is structured to be user-centric, ensuring data isolation and security. Top-level collections are used for major data types, with an 'ownerId' field for ownership-based security rules, which simplifies queries and rules. User-specific settings are stored in a collection where the document ID is the user's UID for direct access."
  }
}
